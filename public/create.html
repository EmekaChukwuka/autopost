<!DOCTYPE html>
<html lang="en" data-theme="light">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Create Post | AutoPost</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <link rel="stylesheet" href="style.css">
  <link rel="icon" href="autopost-icon.jpg">
  <style>
    /* ===== Base Styles ===== */
    :root {
      /* Light Mode */
      --bg-primary: #ffffff;
      --bg-secondary: #f5f5f5;
      --text-primary: #000000;
      --text-secondary: #333333;
      --border-color: #e0e0e0;
      --accent-blue: #2962FF;
      --accent-green: #00C853;
      --error-red: #D32F2F;
    }

    [data-theme="dark"] {
      /* Dark Mode */
      --bg-primary: #121212;
      --bg-secondary: #1e1e1e;
      --text-primary: #ffffff;
      --text-secondary: #e0e0e0;
      --border-color: #333333;
      --accent-blue: #448AFF;
    }

    body {
      font-family: 'Inter', sans-serif;
      margin: 0;
      padding: 0;
      background-color: var(--bg-primary);
      color: var(--text-primary);
      transition: background 0.3s ease;
    }
    /* ===== AI Generator Panel ===== */
    .ai-generator {
      background-color: var(--bg-primary);
      border: 1px solid var(--border-color);
      border-radius: 8px;
      padding: 3%;
      margin:0;
      box-shadow: 0 2px 10px rgba(0,0,0,0.05);

    }

    .ai-generator h2 {
      color: var(--text-primary);
      margin-top: 0;
      text-align:center;
    }

    /* Input Section */
    .input-section {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 20px;
      margin-bottom: 30px;
      padding:2% 2%;
    }

    @media (max-width: 768px) {
      .input-section {
        grid-template-columns: 1fr;
      }
    }

    .input-section label {
      display: block;
      margin-bottom: 8px;
      font-weight: 500;
      color: var(--text-primary);
    }

    .input-section select{
      width: 80%;
      padding: 12px 15px;
      border: 1px solid var(--border-color);
      border-radius: 6px;
      background-color: var(--bg-primary);
      color: var(--text-primary);
      margin-left:10%;
    }
    
    
    .input-section input{
      width: 80%;
      padding: 12px 15px;
      border: 1px solid var(--border-color);
      border-radius: 6px;
      background-color: var(--bg-primary);
      color: var(--text-primary);
      margin-left:4%;
    }

    /* Platform Selector */
    .platform-selector {
      display:flex;
      justify-content:center;
      gap: 10px;
      flex-wrap: wrap;
    }

label{
    text-align: center;
}

    .form-label {
      display: block;
      margin-bottom: 8px;
      font-weight: 500;
    }

    .form-input {
      width: 70%;
      padding: 12px 15px;
      border: 1px solid var(--border-color);
      border-radius: 6px;
      background-color: var(--bg-primary);
      color: var(--text-primary);
      font-size: 16px;
      
      margin-right:10%;
    }

    .form-input:focus {
      outline: none;
      border-color: var(--accent-blue);
    }


    .platform-badge {
      padding: 8px 15px;
      border: 1px solid var(--border-color);
      border-radius: 20px;
      cursor: pointer;
      display: flex;
      align-items: center;
      gap: 8px;
      transition: all 0.2s ease;
      margin:2% 0;
    }

    .platform-badge:hover {
      border-color: var(--accent-blue);
    }

    .platform-badge.active {
      border-color: var(--accent-blue);
      background-color: rgba(41, 98, 255, 0.1);
    }

    /* Buttons */
    button {
      padding: 12px 24px;
      background-color: var(--accent-blue);
      color: white;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      font-weight: 500;
      transition: opacity 0.2s ease;
      margin-left:10%;
      margin-top:5%;
    }

    button:hover {
      opacity: 0.9;
    }

    #generateBtn {
      grid-column: span 2;
      margin-top: 10px;
    }

    @media (max-width: 768px) {
      #generateBtn {
        grid-column: span 1;
      }
    }

    /* AI Output Section */
    .ai-output {
      display: grid;
      grid-template-columns: 2fr 1fr;
      gap: 30px;
      margin-top: 30px;
    }

    @media (max-width: 992px) {
      .ai-output {
        grid-template-columns: 1fr;
      }
    }

    .generated-content {
      background-color: var(--bg-secondary);
      border-radius: 8px;
      padding: 20px;
    }

    .generated-content h3 {
      margin-top: 0;
      color: var(--accent-blue);
    }

    #aiText {
      min-height: 150px;
      padding: 15px;
      background-color: var(--bg-primary);
      border-radius: 4px;
      border: 1px solid var(--border-color);
      white-space: pre-line;
    }

    .loading {
      display: flex;
      align-items: center;
      gap: 10px;
      color: var(--text-secondary);
    }

    .generated-hashtags {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      margin-top: 15px;
    }

    .generated-hashtags span {
      display: inline-block;
      padding: 4px 10px;
      background-color: var(--accent-blue);
      color: white;
      border-radius: 20px;
      font-size: 12px;
    }

    /* Post Settings */
    .post-settings {
      background-color: var(--bg-secondary);
      border-radius: 8px;
      padding: 20px;
      opacity:0.3;
    }

.scheduleOptions label{
    text-align: center;
}
    .post-settings h3 {
      margin-top: 0;
      color: var(--accent-blue);
    }

    .post-settings label {
      display: flex;
      align-items: center;
      gap: 8px;
      margin-bottom: 15px;
      cursor: pointer;
    }

    .post-settings input[type="checkbox"] {
      width: auto;
    }

    #scheduleOptions {
      margin-top: 20px;
      padding-top: 20px;
      border-top: 1px solid var(--border-color);
      
    }
 .post-settings select{
      width: 80%;
      padding: 12px 15px;
      border: 1px solid var(--border-color);
      border-radius: 6px;
      background-color: var(--bg-primary);
      color: var(--text-primary);
      margin-left:10%;
      margin-bottom:3%;
    }
    .post-settings input{
      width: 80%;
      padding: 12px 15px;
      border: 1px solid var(--border-color);
      border-radius: 6px;
      background-color: var(--bg-primary);
      color: var(--text-primary);
      margin-left:5%;
      margin-bottom:3%;
    }
    
    

/* Mobile Bottom Nav */
.bottom-nav {
  display: flex;
  justify-content: space-around;
  align-items: center;
  padding: 0.8rem 0;
  background-color: var(--white);
  border-top: 1px solid var(--gray-medium);
  position: fixed;
  bottom: 0;
  width: 100%;
}

.bottom-nav a {
  color: var(--gray-dark);
  text-decoration: none;
  font-size: 1.2rem;
}

.bottom-nav a.active {
  color: var(--accent-blue);
}


.logo {
  font-weight: 700;
  font-size: 1.2rem;
}

.logo span{
    color:var(--accent-blue);
}
.icons i {
  margin-left: 1rem;
  cursor: pointer;
}
.dashboard {
  display: flex;
  min-height: calc(100vh - 60px);
}
        /* ===== Sidebar ===== */
        .sidebar {
            background: var(--bg-primary);
            border-right: 1px solid var(--border-color);
            padding: 24px;
            position: fixed;
            top: 0;
            width:20%;
            height: 100vh;
        }

        .logo {
            font-size: 20px;
            font-weight: 700;
            margin-bottom: 32px;
            color: var(--text-primary);
            display: flex;
            align-items: center;
        }

        .logo span {
            color: var(--accent-blue);
        }

        a{
            text-decoration: none;
        }
        
        .logo-icon {
            width: 24px;
            height: 24px;
            background-color: var(--accent-blue);
            color: white;
            border-radius: 4px;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            margin-right: 8px;
            font-weight: bold;
        }

        .nav-item {
            display: flex;
            align-items: center;
            padding: 12px 16px;
            margin-bottom: 8px;
            border-radius: 6px;
            cursor: pointer;
            color: var(--text-secondary);
            transition: all 0.2s;
        }

        .nav-item i {
            margin-right: 12px;
            width: 20px;
            text-align: center;
        }

        .nav-item.active {
            background-color: var(--accent-blue);
            color: var(--text-primary);
            font-weight: 500;
        }

        .nav-item:hover:not(.active) {
            background-color: var(--bg-secondary);
        }
/*.sidebar {
  width: 250px;
  background-color: var(--white);
  border-right: 1px solid var(--gray-medium);
  padding:2%;
  background:var(--bg-secondary);
  display: none;  Hidden on mobile 
  left:0;
            height: 100vh;
            position:fixed;
}

.sidebar nav ul {
  list-style: none;
  padding: 0;
}
        .sidebar nav a{
          text-decoration: none;
        }

        .sidebar nav li {
            display: flex;
            align-items: center;
            padding: 12px 16px;
            margin-bottom: 8px;
            border-radius: 6px;
            cursor: pointer;
            color: var(--text-secondary);
            transition: all 0.2s;
        }

        .sidebar nav li i {
            margin-right: 12px;
            width: 20px;
            text-align: center;
        }

        .sidebar nav li.active {
            background-color: var(--accent-blue);
            color: var(--text-primary);
            font-weight: 500;
        }

        .sidebar nav li:hover:not(.active) {
            background-color: var(--bg-secondary);
        }


.sidebar {
  width: 19%;
  background-color: var(--bg-primary);
  border-right: 1px solid var(--gray-medium);
  padding:2%;
  background:var(--bg-secondary);
  display: none;  Hidden on mobile 
    position:fixed;
  margin-top:5%;
  left:0;
            height: 100vh;
}

.sidebar nav ul {
  list-style: none;
  padding: 0;
}
.sidebar {
            background: var(--bg-primary);
            border-right: 1px solid var(--border-color);
            padding: 24px;
            position: sticky;
            top: 0;
            height: 100vh;
        }

        .sidebar nav a{
          text-decoration: none;
        }

        .sidebar nav li {
            display: flex;
            align-items: center;
            padding: 12px 20px;
            margin-bottom: 8px;
            border-radius: 6px;
            cursor: pointer;
            color: var(--text-secondary);
            transition: all 0.2s;
        }

        .sidebar nav li i {
            margin-right: 12px;
            width: 20px;
            text-align: center;
        }

        .sidebar nav li.active {
            background-color: var(--accent-blue);
            color: var(--text-primary);
            font-weight: 500;
        }

        .sidebar nav li:hover:not(.active) {
            background-color: var(--bg-secondary);
        }*/
.content {
  flex: 1;
  padding: 1rem;
}

    @media (max-width: 768px) {
      .history-item {
        grid-template-columns: 1fr;
      }
      
      .platform-selector {
      display:flex;
      flex-direction:column;
      gap: 10px;
      flex-wrap: wrap;
    }

.top-bar{
  display:none;
}

.sidebar{
  display:none;
}

body{
  padding: 0;
  margin:0;
  width:100%;
}
#generateBtn{
 margin-left:1%;
}
/* Mobile Bottom Nav */
.bottom-nav {
  display: flex;
  justify-content: space-around;
  align-items: center;
  padding: 0.8rem 0;
  background-color: var(--bg-primary);
  border-top: 1px solid var(--gray-medium);
  position: fixed;
  bottom: 0;
  width: 100%;
}

.bottom-nav a {
  color: var(--gray-dark);
  text-decoration: none;
  font-size: 1.2rem;
}

.bottom-nav a.active {
  color: var(--accent-blue);
}
.top-bar{
  display:none;
}
.ai-generator {
      background-color: var(--bg-primary);
      border-radius: 8px;
      padding: 10vw;
      margin:5vw;
      box-shadow: 0 2px 10px rgba(0,0,0,0.05);
      display:block;
    }


    }
    @media (min-width: 768px) {
     .sidebar {
    display: block;
  }
  .bottom-nav {
    display: none;
  }

  .theme-toggle {
    position:fixed;
      top: 20px;
      right: 20px;
    }
   .ai-generator{
    width:70%;
    margin-left:20%;
    margin-top:0;
  }

 
.main{
  margin-left:7%;
  margin-bottom:3%;
  margin-top:3%;
}
    }


    

  .theme-toggle {
    display: flex;
    align-items: center;
    }
    .toggle-label {
      margin: 0 15px;
      font-weight: 500;
    }

    .toggle-switch {
      position: relative;
      display: inline-block;
      width: 60px;
      height: 30px;
      margin:0 15px;
    }

    .toggle-switch input {
      opacity: 0;
      width: 0;
      height: 0;
    }

    .toggle-slider {
      position: absolute;
      cursor: pointer;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background-color: var(--border-color);
      transition: .4s;
      border-radius: 34px;
    }

    .toggle-slider:before {
      position: absolute;
      content: "";
      height: 22px;
      width: 22px;
      left: 4px;
      bottom: 4px;
      background-color: var(--bg-primary);
      transition: .4s;
      border-radius: 50%;
    }

    input:checked + .toggle-slider {
      background-color: var(--accent-blue);
    }

    input:checked + .toggle-slider:before {
      transform: translateX(30px);
    }
    

  </style>
</head>
<body>
<div class="dashboard">
        <!-- Sidebar -->
        <div class="sidebar">
            <div class="logo">Auto<span>Post</span></div>
            <a href="dashboard.html"><div class="nav-item" data-page="home">
                <i class="fas fa-home"></i><span>Dashboard</span>
            </div></a>
            <a href="#" class="nav-item active"><div data-page="create">
                <i class="fas fa-plus"></i><span>Create Post</span>
            </div></a>
           <a href="calendar.html"><div class="nav-item" data-page="calendar">
                <i class="fas fa-calendar-alt"></i><span>Calendar</span>
            </div></a>
           <a href="analytics.html"><div class="nav-item" data-page="analytics">
                <i class="fas fa-chart-line"></i><span>Analytics</span>
            </div></a>
           <a href="settings.html"> <div class="nav-item" data-page="settings">
                <i class="fas fa-cog"></i><span>Settings</span>
            </div></a>
        </div>


        
<main class="main">
  <!-- AI Content Generator Panel -->
  <section class="ai-generator">
    <h2><i class="fas fa-robot" style="color: var(--accent-blue);"></i> AI Content Creator</h2>
    
    <div class="input-section">
        <div>
        <div class="form-group">
            <label for="email" class="form-label">Content Idea</label>
            <input type="name" id="prompt" class="form-input" placeholder="Type in a word related to what you want to create eg. Messi for Messi related football posts" required>
           
          </div>      
        </div>
      <div>
        <label for="contentType">Content Type</label>
        <select id="contentType">
          <option value="trending">Trending Topics</option>
          <option value="promotional">Promotional Post</option>
          <option value="educational">Educational Content</option>
          <option value="funny">Entertainment</option>
        </select>
      </div>
      
      <div><form>
        <label>Platform</label>
        <div class="platform-selector">
          <div class="platform-badge twitter active" data-platform="X">
            <i class="fab fa-twitter"></i> &nbsp X
          </div>
          <div class="platform-badge facebook" data-platform="Facebook">
            <i class="fab fa-facebook"></i>&nbsp Facebook
          </div>
          <div class="platform-badge linkedin" data-platform="LinkedIn">
            <i class="fab fa-linkedin"></i>&nbsp LinkedIn
          </div>
          <div class="platform-badge instagram" data-platform="Instagram">
            <i class="fab fa-instagram"></i>&nbsp Instagram
          </div>
          <div class="platform-badge twitter" data-platform="TikTok">
            <i class="fab fa-tiktok"></i> &nbsp TikTok
          </div>
        </div>
        </form>
      </div>
      
      <button id="generateBtn">Generate Content</button>
    </div>
    
    <div class="ai-output">
      <div class="generated-content">
        <h3>AI-Generated Post</h3>
        <div id="aiText" contentEditable>[AI will generate content here]</div>
        <div class="generated-hashtags">
          <!-- Hashtags will be inserted here by JavaScript -->
        </div>
        <button onclick="copyToClipboard()">Copy to Clipboard</button>
      </div>
      
      <div class="post-settings">
        <h3>Auto-Post Settings</h3>
        <h3 style="opacity:1;">Coming Soon</h3>
        <label>
          <input type="checkbox" id="autoPost" disabled> Post automatically
        </label>
        <div id="scheduleOptions">
          <label>Schedule Time</label>
          <input type="time" id="postTime" disabled>
          <label>Time Zone</label>
          <select id="timeZone" disabled>
            <option value="WAT">West Africa Time (WAT)</option>
          </select>
        </div>
        <button id="confirmPost" disabled>Confirm & Schedule</button>
      </div>
    </div>
  </section>

  
  
  <!-- Mobile Bottom Nav -->
  <nav class="bottom-nav">
    <a href="dashboard.html"><i class="fas fa-home"></i></a>
    <a href="calendar.html"><i class="fas fa-calendar-alt"></i></a>
    <a href="#"  class="active"><i class="fas fa-plus"></i></a>
    <a href="analytics.html"><i class="fas fa-chart-line"></i></a>
    <a href="settings.html"><i class="fas fa-user"></i></a>
  </nav>
  <script>
   // localStorage.removeItem('trialData')
    // Dark Mode Toggle
    const root = document.documentElement;

    if (localStorage.getItem('theme') === 'dark') {
      root.setAttribute('data-theme', 'dark');
    }


    // Platform Selection
    const platformBadges = document.querySelectorAll('.platform-badge');
    platformBadges.forEach(badge => {
      badge.addEventListener('click', () => {
        platformBadges.forEach(b => b.classList.remove('active'));
        badge.classList.add('active');
      });
    });

    // AI Content Generation
    document.getElementById('generateBtn').addEventListener('click', async () => {
      const contentType = document.getElementById('contentType').value;
      const prompt = document.getElementById('prompt').value;
      const platform = document.querySelector('.platform-badge.active').dataset.platform;
      
      // Show loading state
      document.getElementById('aiText').innerHTML = 
        '<div class="loading"><i class="fas fa-spinner fa-spin"></i> Generating content...</div>';
   
        const trialData=JSON.parse(localStorage.getItem('trialData'));
             const paidPlan = JSON.parse(localStorage.getItem('paymentSuccess'));
             if(trialData === null && paidPlan === null){
               document.getElementById('aiText').innerHTML = '<p>Please start your free trial or subscribe to a plan to use this feature</p>';
               return;
             }
                if(trialData && !paidPlan){
        const now = new Date();
                const endDate = new Date(trialData.endDate);
                const timeRemaining = endDate - now;
                console.log(timeRemaining);

      if(timeRemaining <= 0){
        document.getElementById('aiText').innerHTML = '<p>Your free trial has expired, please start your billing to continue using this feature</p>';
      }
if(timeRemaining > 0){
      // API call to AI backend
  try{
      const response = await fetch('https://autopost-backend-hbck.onrender.com/api/generate', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ prompt, platform, contentType}) // Updated
    });
            
            const result = await response.json();
            
            document.getElementById('aiText').innerHTML = result.data;
              const postDetails = {
              date: now,
              post:result.data,
              platform:platform
            };
            updatePost(postDetails);
          
    }catch(error){
      console.log('error', error);
       document.getElementById('aiText').innerHTML = 'An error occured, please try again';
    }
  }}

  if(!trialData && paidPlan){
      // API call to AI backend
      const now = new Date();
  try{
      const response = await fetch('https://autopost-backend-hbck.onrender.com/api/generate', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ prompt, platform, contentType}) // Updated
    });
            const result = await response.json();
            document.getElementById('aiText').innerHTML = result.data;
              const postDetails = {
              date: now,
              post:result.data,
              platform:platform
            };
            updatePost(postDetails);
    }catch(error){
      console.log('error', error);
       document.getElementById('aiText').innerHTML = 'An error occured, please try again';
    }
  }
                });
              
    async function updatePost(postDetails){
       try{
        
    const user = JSON.parse(localStorage.getItem('currentUser'));
    const id = user.id;
    console.log(user.id);
            console.log(postDetails);
        const postDetailsDate = postDetails.date;
        const postDetailsPost = postDetails.post;
        const postDetailsPlatform = postDetails.platform;
        console.log(postDetailsDate);
              const response = await fetch('https://autopost-backend-hbck.onrender.com/register/saveContent', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ id, postDetailsDate, postDetailsPost, postDetailsPlatform}) 
    });
            
            const result = await response.json();
            }catch(error){
              
              console.log('failed to upload post', error);
            }
       
    }
    
    
    
    // Auto-Post Functionality
    document.getElementById('confirmPost').addEventListener('click', () => {
      const content = document.getElementById('aiText').innerText;
      const platform = document.querySelector('.platform-badge.active').dataset.platform;
      const autoPost = document.getElementById('autoPost').checked;
      const postTime = document.getElementById('postTime').value;
      
      if (autoPost) {
        // Connect to social media APIs
        postToSocialMedia(platform, content, postTime);
      }
    });
    
        function copyToClipboard() {
            const text = document.getElementById('aiText').innerText;
            navigator.clipboard.writeText(text);
            alert("Copied! Paste it into your social media.");
        }
         
    async function postToSocialMedia(platform, content, scheduleTime) {
      // In a real implementation, this would connect to:
      // - Twitter API v2
      // - Instagram Graph API
      // - TikTok Business API
      
      alert(`Content scheduled for ${platform} at ${scheduleTime} WAT!`);
      
    }  
  </script>
</body>
</html>